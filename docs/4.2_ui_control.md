# 4.2 User Interfaces Control
Microcity Script can be used to control some features appearing in user interfaces, which include moduels, data objects, messages and so on. There are some sample codes can be found in the "user_interface" folder of the **Project** Tab in ![icon](imgs/icon_script_editor.png)**ScriptEditor**.
## Modules and Parameters
```lua
AddModule ("function" [, "name"]) 
```
This function can add a lua function as a module to current module library. The module's default name is the function's name. Returns a *Module* object. 

```lua
AddParameter (module, parent_node, "node",   "description")
AddParameter (module, parent_node, "value",  "description" [, default = 0])
AddParameter (module, parent_node, "range",  "description" [, low = 0 [,  high = 1]])
AddParameter (module, parent_node, "check",  "description" [, boolean = true])
AddParameter (module, parent_node, "string", "description" [, "string" = "")
AddParameter (module, parent_node, "choice", "description" , "choice1|choice2|" [, choice = 1])
AddParameter (module, parent_node, "file",   "description" [, "c:\\default.txt" = ""])
AddParameter (module, parent_node, "scene",  "description")
AddParameter (module, parent_node, "shapes", "description")
AddParameter (module, parent_node, "grid",   "description")
AddParameter (module, parent_node, "table",  "description")
AddParameter (module, parent_node, "field",  "description")
```
These functions can add a parameter to a module's settings panel. Returns corresponding values or an object. The *parent_node* can be set to the first return of a *AddParameter* function. If *"field"* is set at the third place, the *parent_node* can be set to a *Table* or *Shapes* object to get its attributes table's head.

```lua
GetParameter (Shapes|Table|Grid|Module, "id")
```
Returns the *"id"* property from the object's settings panel.
```lua
SetParameter (Shapes|Table|Grid|Module, "id", number|"string"|object)
```
Sets the *"id"* property in the object's settings panel. Returns *true* if succeed. Note that the choice parameter should start from 1. The *"id"* can be the following values.

**General Properties:**
```lua
OBJECT_NAME OBJECT_DESC SHOW_LEGEND SHOW_ALWAYS SHOW_RANGE GENERAL_NODATA DISPLAY_TRANSPARENCY 
COLORS_TYPE UNISYMBOL_COLOR METRIC_COLORS METRIC_ZRANGE METRIC_SCALE_MODE METRIC_SCALE_LOG
```
**Shapes Properties:**
```lua
DISPLAY_POINTS DISPLAY_BRUSH DISPLAY_CENTROID LINE_STYLE OUTLINE OUTLINE_COLOR OUTLINE_SIZE 
DISPLAY_SYMBOL_TYPE DISPLAY_SYMBOL_IMAGE LABEL_ANGLE_ATTRIB LABEL_ANGLE LABEL_ALIGN_X LABEL_ALIGN_Y 
SIZE_TYPE SIZE_ATTRIB SIZE_SCALE SIZE_RANGE SIZE_DEFAULT
```
**Grid Properties:**  
```lua
DISPLAY_INTERPOLATION SHADE_MODE VALUES_SHOW
```
## Data Objects
```lua
PATH
```
Internal global variable that holds a string of current working directory, such as "c:\microcity".
```lua
Open (".\\shapes.shp" [, ".\\grid.sgrd" [, ".\\table.dbf" [, ".\\scene.m3d" , ...]]])
```
Opens and returns *Shapes*, *Table*, *Grid* and *Scene* object from current working directory or opened data.
```lua
Close (Shapes|Grid|Table|Scene|Network|RndEngine|LPModel)
```
Closes an opened or created *Shapes*, *Table*, *Grid*, *Scene*, *Network*, *RndEngine* or *LPModel* object.
```lua
Update (Shapes|Grid|Table [, bShow = ture])
```
Update current changes of *Shapes*, *Grid* or *Table* object in *MicroCity*. The *bShow* indicates whether to create a view of the object. Returns false if user cancel the current execution.
```lua
CreateView ("name", Shapes1|Grid1 [, Shapes2|Grid2, ...])
```
Creates a *Map View* to show objects which can be arranged in layers by their order in the parameters.

## Other User Interfaces
```lua
Print ("Hello" [,...])
```
Prints values in the *Messages Panel*. 
```lua
Note ("Hello" [,...])
```
Notifies user and pauses the execution.
```lua
SetProcessText ("Circle")
```
Sets a text at the bottom left corner of *MicroCity*.
```lua
SetProgress (Position, Range)
```
Sets the progress bar of *Position/Range* that locates at the bottom right conner of *MicroCity*. 
```lua
Sleep (Milliseconds)
```
Pauses the execution for *Milliseconds*.
```lua
GetReady ()
```
Returns false if user cancel the current execution.
```lua
GetClickXY ()
```
Returns x,y where a user clicked at a *Map View*.
```lua
GetDragExtent ()
```
Returns bottom-left and top-right corner coordinate: Lx, By, Rx, Ty, which a user used mouse to drag a rectangle in a *Map View*.


[**< 4.1 SI Overview**](4.1_si_overview.md) | [**Table of Contents**](.) | [**4.3 Shapes and Tables >**](4.3_shapes_and_tables.md)
